{% extends 'base.jinja.html' %}

{% block title %}프로필 완성 - 보험 추천 시스템{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-user-edit me-3" style="font-size: 2rem;"></i>
                        <div>
                            <h4 class="mb-0">프로필 정보 입력</h4>
                            <small>더 정확한 보험 추천을 위해 정보를 입력해주세요</small>
                        </div>
                    </div>
                </div>
                <div class="card-body p-4">
                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}
                        
                        <!-- 성공 메시지 -->
                        {% if messages %}
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <i class="fas fa-check-circle me-2"></i>
                            {% for message in messages %}
                                {{ message }}
                            {% endfor %}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        {% endif %}

                        <!-- 기본 정보 섹션 -->
                        <div class="mb-4">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-info-circle me-2"></i>기본 정보
                            </h5>
                            
                            <!-- 나이 -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="id_age" class="form-label fw-bold">
                                        <i class="fas fa-birthday-cake me-2"></i>나이
                                    </label>
                                    <input type="number" 
                                           class="form-control form-control-lg {% if form.age.errors %}is-invalid{% endif %}" 
                                           id="id_age" 
                                           name="age" 
                                           placeholder="나이를 입력하세요"
                                           min="18" 
                                           max="100"
                                           value="{{ form.age.value|default:'' }}">
                                    {% if form.age.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.age.errors.0 }}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <!-- 성별 -->
                                <div class="col-md-6">
                                    <label for="id_gender" class="form-label fw-bold">
                                        <i class="fas fa-venus-mars me-2"></i>성별
                                    </label>
                                    <select class="form-select form-select-lg {% if form.gender.errors %}is-invalid{% endif %}" 
                                            id="id_gender" 
                                            name="gender">
                                        <option value="">성별을 선택하세요</option>
                                        <option value="M" {% if form.gender.value == 'M' %}selected{% endif %}>남성</option>
                                        <option value="F" {% if form.gender.value == 'F' %}selected{% endif %}>여성</option>
                                    </select>
                                    {% if form.gender.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.gender.errors.0 }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- 거주 지역 -->
                            <div class="mb-3">
                                <label for="id_residence_area" class="form-label fw-bold">
                                    <i class="fas fa-map-marker-alt me-2"></i>거주 지역
                                </label>
                                <select class="form-select form-select-lg {% if form.residence_area.errors %}is-invalid{% endif %}" 
                                        id="id_residence_area" 
                                        name="residence_area">
                                    <option value="">거주 지역을 선택하세요</option>
                                    <option value="서울" {% if form.residence_area.value == '서울' %}selected{% endif %}>서울</option>
                                    <option value="부산" {% if form.residence_area.value == '부산' %}selected{% endif %}>부산</option>
                                    <option value="대구" {% if form.residence_area.value == '대구' %}selected{% endif %}>대구</option>
                                    <option value="인천" {% if form.residence_area.value == '인천' %}selected{% endif %}>인천</option>
                                    <option value="광주" {% if form.residence_area.value == '광주' %}selected{% endif %}>광주</option>
                                    <option value="대전" {% if form.residence_area.value == '대전' %}selected{% endif %}>대전</option>
                                    <option value="울산" {% if form.residence_area.value == '울산' %}selected{% endif %}>울산</option>
                                    <option value="세종" {% if form.residence_area.value == '세종' %}selected{% endif %}>세종</option>
                                    <option value="경기" {% if form.residence_area.value == '경기' %}selected{% endif %}>경기</option>
                                    <option value="강원" {% if form.residence_area.value == '강원' %}selected{% endif %}>강원</option>
                                    <option value="충북" {% if form.residence_area.value == '충북' %}selected{% endif %}>충북</option>
                                    <option value="충남" {% if form.residence_area.value == '충남' %}selected{% endif %}>충남</option>
                                    <option value="전북" {% if form.residence_area.value == '전북' %}selected{% endif %}>전북</option>
                                    <option value="전남" {% if form.residence_area.value == '전남' %}selected{% endif %}>전남</option>
                                    <option value="경북" {% if form.residence_area.value == '경북' %}selected{% endif %}>경북</option>
                                    <option value="경남" {% if form.residence_area.value == '경남' %}selected{% endif %}>경남</option>
                                    <option value="제주" {% if form.residence_area.value == '제주' %}selected{% endif %}>제주</option>
                                </select>
                                {% if form.residence_area.errors %}
                                <div class="invalid-feedback">
                                    {{ form.residence_area.errors.0 }}
                                </div>
                                {% endif %}
                            </div>

                            <!-- 직업 -->
                            <div class="mb-3">
                                <label for="id_occupation" class="form-label fw-bold">
                                    <i class="fas fa-briefcase me-2"></i>직업
                                </label>
                                <input type="text" 
                                       class="form-control form-control-lg {% if form.occupation.errors %}is-invalid{% endif %}" 
                                       id="id_occupation" 
                                       name="occupation" 
                                       placeholder="직업을 입력하세요"
                                       value="{{ form.occupation.value|default:'' }}">
                                {% if form.occupation.errors %}
                                <div class="invalid-feedback">
                                    {{ form.occupation.errors.0 }}
                                </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- 보험 관련 정보 섹션 -->
                        <div class="mb-4">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-car me-2"></i>보험 관련 정보
                            </h5>
                            
                            <!-- 차량 정보 -->
                            <div class="mb-3">
                                <label for="id_car_info" class="form-label fw-bold">
                                    <i class="fas fa-car me-2"></i>차량 정보
                                </label>
                                <select class="form-select form-select-lg {% if form.car_info.errors %}is-invalid{% endif %}" 
                                        id="id_car_info" 
                                        name="car_info">
                                    <option value="">차량 종류를 선택하세요</option>
                                    <option value="경차" {% if form.car_info.value == '경차' %}selected{% endif %}>경차</option>
                                    <option value="소형" {% if form.car_info.value == '소형' %}selected{% endif %}>소형</option>
                                    <option value="준중형" {% if form.car_info.value == '준중형' %}selected{% endif %}>준중형</option>
                                    <option value="중형" {% if form.car_info.value == '중형' %}selected{% endif %}>중형</option>
                                    <option value="대형" {% if form.car_info.value == '대형' %}selected{% endif %}>대형</option>
                                    <option value="SUV" {% if form.car_info.value == 'SUV' %}selected{% endif %}>SUV</option>
                                </select>
                                {% if form.car_info.errors %}
                                <div class="invalid-feedback">
                                    {{ form.car_info.errors.0 }}
                                </div>
                                {% endif %}
                            </div>

                            <!-- 운전 경력 -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="id_driving_experience" class="form-label fw-bold">
                                        <i class="fas fa-calendar-alt me-2"></i>운전 경력
                                    </label>
                                    <input type="number" 
                                           class="form-control form-control-lg {% if form.driving_experience.errors %}is-invalid{% endif %}" 
                                           id="id_driving_experience" 
                                           name="driving_experience" 
                                           placeholder="운전 경력 (년)"
                                           min="0" 
                                           max="50"
                                           value="{{ form.driving_experience.value|default:'' }}">
                                    {% if form.driving_experience.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.driving_experience.errors.0 }}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <!-- 사고 이력 -->
                                <div class="col-md-6">
                                    <label for="id_accident_history" class="form-label fw-bold">
                                        <i class="fas fa-exclamation-triangle me-2"></i>사고 이력
                                    </label>
                                    <input type="number" 
                                           class="form-control form-control-lg {% if form.accident_history.errors %}is-invalid{% endif %}" 
                                           id="id_accident_history" 
                                           name="accident_history" 
                                           placeholder="사고 횟수"
                                           min="0" 
                                           max="10"
                                           value="{{ form.accident_history.value|default:'' }}">
                                    {% if form.accident_history.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.accident_history.errors.0 }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- 연간 주행거리 -->
                            <div class="mb-3">
                                <label for="id_annual_mileage" class="form-label fw-bold">
                                    <i class="fas fa-road me-2"></i>연간 주행거리
                                </label>
                                <input type="number" 
                                       class="form-control form-control-lg {% if form.annual_mileage.errors %}is-invalid{% endif %}" 
                                       id="id_annual_mileage" 
                                       name="annual_mileage" 
                                       placeholder="연간 주행거리 (km)"
                                       min="0" 
                                       max="100000"
                                       value="{{ form.annual_mileage.value|default:'' }}">
                                <div class="form-text">예: 10000 (1만km)</div>
                                {% if form.annual_mileage.errors %}
                                <div class="invalid-feedback">
                                    {{ form.annual_mileage.errors.0 }}
                                </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- 제출 버튼 -->
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-save me-2"></i>정보 저장
                            </button>
                            <a href="{% url 'users:profile' %}" class="btn btn-outline-secondary btn-lg">
                                <i class="fas fa-arrow-left me-2"></i>프로필로 돌아가기
                            </a>
                        </div>
                    </form>
                </div>
            </div>

            <!-- 도움말 카드 -->
            <div class="card shadow-lg border-0 mt-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-question-circle me-2"></i>도움말
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">
                                <i class="fas fa-lightbulb me-2"></i>왜 이 정보가 필요한가요?
                            </h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>나이와 성별에 따른 요율 차등 적용</li>
                                <li><i class="fas fa-check text-success me-2"></i>지역별 보험료 차이 반영</li>
                                <li><i class="fas fa-check text-success me-2"></i>운전 경력에 따른 할인 혜택</li>
                                <li><i class="fas fa-check text-success me-2"></i>차량 종류별 보험료 계산</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">
                                <i class="fas fa-shield-alt me-2"></i>개인정보 보호
                            </h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-lock text-success me-2"></i>모든 정보는 암호화되어 저장됩니다</li>
                                <li><i class="fas fa-lock text-success me-2"></i>보험 추천 목적으로만 사용됩니다</li>
                                <li><i class="fas fa-lock text-success me-2"></i>제3자에게 제공되지 않습니다</li>
                                <li><i class="fas fa-lock text-success me-2"></i>언제든지 삭제할 수 있습니다</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 15px;
    }
    
    .form-control-lg, .form-select-lg {
        font-size: 1.1rem;
        padding: 0.75rem 1rem;
    }
    
    .btn-lg {
        font-size: 1.1rem;
        padding: 0.75rem 1.5rem;
    }
    
    .form-label {
        font-size: 1.1rem;
    }
    
    /* 시니어 친화적 색상 */
    .bg-primary {
        background-color: #667eea !important;
    }
    
    .bg-info {
        background-color: #17a2b8 !important;
    }
    
    .text-primary {
        color: #667eea !important;
    }
    
    .btn-primary {
        background-color: #667eea;
        border-color: #667eea;
    }
    
    .btn-primary:hover {
        background-color: #5a6fd8;
        border-color: #5a6fd8;
    }
    
    .text-success {
        color: #28a745 !important;
    }
</style>

<script>
    // 폼 유효성 검사
    (function() {
        'use strict';
        window.addEventListener('load', function() {
            var forms = document.getElementsByClassName('needs-validation');
            var validation = Array.prototype.filter.call(forms, function(form) {
                form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
</script>
{% endblock %} 