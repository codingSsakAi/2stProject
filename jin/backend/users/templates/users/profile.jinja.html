{% extends 'base.jinja.html' %}

{% block title %}프로필 - 보험 추천 시스템{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <!-- 프로필 카드 -->
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-user-circle me-3" style="font-size: 2rem;"></i>
                        <div>
                            <h4 class="mb-0">사용자 프로필</h4>
                            <small>개인화된 보험 추천을 위한 정보입니다</small>
                        </div>
                    </div>
                </div>
                <div class="card-body p-4">
                    <!-- 사용자 기본 정보 -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-info-circle me-2"></i>기본 정보
                            </h5>
                            <div class="mb-3">
                                <label class="form-label fw-bold">아이디</label>
                                <p class="form-control-plaintext">{{ user.username }}</p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">가입일</label>
                                <p class="form-control-plaintext">{{ user.date_joined|date:"Y년 m월 d일" }}</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-car me-2"></i>보험 관련 정보
                            </h5>
                            <div class="mb-3">
                                <label class="form-label fw-bold">차량 정보</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.car_info %}
                                        {{ user_profile.car_info }}
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">운전 경력</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.driving_experience %}
                                        {{ user_profile.driving_experience }}년
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 상세 정보 -->
                    <div class="row">
                        <div class="col-12">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-chart-bar me-2"></i>상세 정보
                            </h5>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">나이</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.age %}
                                        {{ user_profile.age }}세
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">성별</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.gender %}
                                        {{ user_profile.get_gender_display }}
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">거주 지역</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.residence_area %}
                                        {{ user_profile.residence_area }}
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">직업</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.occupation %}
                                        {{ user_profile.occupation }}
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">연간 주행거리</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.annual_mileage %}
                                        {{ user_profile.annual_mileage }}km
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">사고 이력</label>
                                <p class="form-control-plaintext">
                                    {% if user_profile.accident_history %}
                                        {{ user_profile.accident_history }}회
                                    {% else %}
                                        <span class="text-muted">미입력</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 액션 버튼 -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="d-flex gap-2 flex-wrap">
                                <a href="{% url 'users:profile_completion' %}" class="btn btn-outline-primary btn-lg">
                                    <i class="fas fa-edit me-2"></i>프로필 수정
                                </a>
                                <a href="{% url 'insurance:langchain_dashboard' %}" class="btn btn-primary btn-lg">
                                    <i class="fas fa-robot me-2"></i>AI 챗봇 시작
                                </a>
                                <a href="{% url 'users:logout' %}" class="btn btn-outline-danger btn-lg">
                                    <i class="fas fa-sign-out-alt me-2"></i>로그아웃
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 사이드바 -->
        <div class="col-lg-4">
            <!-- 빠른 액션 카드 -->
            <div class="card shadow-lg border-0 mb-4">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-rocket me-2"></i>빠른 시작
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{% url 'insurance:langchain_dashboard' %}" class="btn btn-success btn-lg">
                            <i class="fas fa-comments me-2"></i>AI 챗봇 상담
                        </a>
                        <a href="{% url 'users:profile_completion' %}" class="btn btn-outline-success btn-lg">
                            <i class="fas fa-user-edit me-2"></i>정보 입력
                        </a>
                    </div>
                </div>
            </div>

            <!-- 정보 완성도 카드 -->
            <div class="card shadow-lg border-0">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie me-2"></i>정보 완성도
                    </h5>
                </div>
                <div class="card-body">
                    {% with completion_rate=user_profile.get_completion_rate %}
                    <div class="text-center mb-3">
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-info" 
                                 role="progressbar" 
                                 style="width: {{ completion_rate }}%"
                                 aria-valuenow="{{ completion_rate }}" 
                                 aria-valuemin="0" 
                                 aria-valuemax="100">
                                {{ completion_rate }}%
                            </div>
                        </div>
                    </div>
                    <p class="text-center mb-0">
                        {% if completion_rate < 50 %}
                            <span class="text-warning">
                                <i class="fas fa-exclamation-triangle me-1"></i>
                                더 정확한 추천을 위해 정보를 입력해주세요.
                            </span>
                        {% elif completion_rate < 80 %}
                            <span class="text-info">
                                <i class="fas fa-info-circle me-1"></i>
                                추가 정보 입력으로 더 정확한 추천을 받을 수 있습니다.
                            </span>
                        {% else %}
                            <span class="text-success">
                                <i class="fas fa-check-circle me-1"></i>
                                충분한 정보가 입력되어 있습니다.
                            </span>
                        {% endif %}
                    </p>
                    {% endwith %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 15px;
    }
    
    .btn-lg {
        font-size: 1.1rem;
        padding: 0.75rem 1.5rem;
    }
    
    .form-label {
        font-size: 1.1rem;
    }
    
    .form-control-plaintext {
        font-size: 1rem;
        padding: 0.375rem 0;
    }
    
    /* 시니어 친화적 색상 */
    .bg-primary {
        background-color: #667eea !important;
    }
    
    .bg-success {
        background-color: #28a745 !important;
    }
    
    .bg-info {
        background-color: #17a2b8 !important;
    }
    
    .text-primary {
        color: #667eea !important;
    }
    
    .btn-primary {
        background-color: #667eea;
        border-color: #667eea;
    }
    
    .btn-primary:hover {
        background-color: #5a6fd8;
        border-color: #5a6fd8;
    }
    
    .btn-outline-primary {
        color: #667eea;
        border-color: #667eea;
    }
    
    .btn-outline-primary:hover {
        background-color: #667eea;
        border-color: #667eea;
    }
    
    .progress {
        border-radius: 10px;
    }
    
    .progress-bar {
        border-radius: 10px;
    }
</style>
{% endblock %} 