{% extends 'base/base.jinja.html' %} {% block title %}프로필 - 자동차 보험 추천 챗봇{% endblock %} {% block content %}
<!-- 버전: {{ version }} -->
<div class="row">
  <div class="col-lg-8 mx-auto">
    <!-- 프로필 헤더 -->
    <div class="card shadow mb-4">
      <div class="card-header bg-primary text-white">
        <h4 class="mb-0">
          <i class="bi bi-person-circle"></i>
          내 프로필
        </h4>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-3 text-center">
            <div class="mb-3">
              <i class="bi bi-person-circle display-1 text-primary"></i>
            </div>
            <h5>{{ user.get_full_name }}</h5>
            <p class="text-muted">@{{ user.username }}</p>
          </div>
          <div class="col-md-9">
            <div class="row">
              <div class="col-sm-6">
                <p>
                  <strong>이메일:</strong>
                  {{ user.email }}
                </p>
                <p>
                  <strong>가입일:</strong>
                  {{ user.date_joined|date:"Y년 m월 d일" }}
                </p>
              </div>
            </div>
            <div class="mt-3">
              <a href="{% url 'accounts:profile_update' %}" class="btn btn-primary">
                <i class="bi bi-pencil"></i>
                프로필 수정
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 보험 추천 정보 요약 -->
    <div class="card shadow mb-4">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0">
          <i class="bi bi-graph-up"></i>
          보험 추천 정보
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label"><strong>생년월일</strong></label>
              <p class="text-muted">
                {% if profile.birth_date %}{{ profile.birth_date|date:"Y년 m월 d일" }}{% else %}미설정{% endif %}
              </p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>나이(만)</strong></label>
              <p class="text-muted">
                {% if profile.birth_date %}{{ profile.get_age }}세{% else %}미설정{% endif %}
              </p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>성별</strong></label>
              <p class="text-muted">
                {% if profile.gender %}{{ profile.get_gender_display }}{% else %}미설정{% endif %}
              </p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>거주 지역</strong></label>
              <p class="text-muted">{{ profile.residence_area|default:"미설정" }}</p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>운전 경력</strong></label>
              <p class="text-muted">
                {% if profile.driving_experience %}{{ profile.driving_experience }}년{% else %}미설정{% endif %}
              </p>
            </div>
            
          </div>
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label"><strong>차종</strong></label>
              <p class="text-muted">{{ profile.car_type|default:"미설정" }}</p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>연간 주행거리</strong></label>
              <p class="text-muted">
                {% if profile.annual_mileage %}{{ profile.annual_mileage }}km{% else %}미설정{% endif %}
              </p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>사고 경력</strong></label>
              <p class="text-muted">{{ profile.accident_history|default:"0" }}회</p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>보장 수준</strong></label>
              <p class="text-muted">{{ profile.coverage_level|default:"미설정" }}</p>
            </div>
            <div class="mb-3">
              <label class="form-label"><strong>추가 특약 관심</strong></label>
              <p class="text-muted">
                {% if profile.additional_coverage_interest %}
                <i class="bi bi-check-circle-fill text-success"></i>
                관심 있음 {% else %}
                <i class="bi bi-x-circle-fill text-muted"></i>
                관심 없음 {% endif %}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 디버깅 정보 (개발용) -->
    {% if user.is_staff %}
    <div class="card shadow mb-4">
      <div class="card-header bg-warning text-dark">
        <h5 class="mb-0">
          <i class="bi bi-bug"></i>
          디버깅 정보 (관리자용)
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>거주 지역:</strong> {{ profile.residence_area|default:"None" }}</p>
            <p><strong>운전 경력:</strong> {{ profile.driving_experience|default:"None" }}</p>
            <p><strong>차종:</strong> {{ profile.car_type|default:"None" }}</p>
            <p><strong>보장 수준:</strong> {{ profile.coverage_level|default:"None" }}</p>
          </div>
          <div class="col-md-6">
            <p><strong>연간 주행거리:</strong> {{ profile.annual_mileage|default:"None" }}</p>
            <p><strong>사고 경력:</strong> {{ profile.accident_history|default:"None" }}</p>
            <p><strong>추가 특약 관심:</strong> {{ profile.additional_coverage_interest|default:"None" }}</p>
            <p><strong>버전:</strong> {{ version|default:"None" }}</p>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- 추천 내역 (향후 구현) -->
    <div class="card shadow">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0">
          <i class="bi bi-clock-history"></i>
          최근 추천 내역
        </h5>
      </div>
      <div class="card-body">
        <div class="text-center py-4">
          <i class="bi bi-inbox display-4 text-muted"></i>
          <p class="text-muted mt-3">아직 추천 내역이 없습니다.</p>
          <a href="{% url 'chatbot:chat' %}" class="btn btn-outline-primary">
            <i class="bi bi-chat-dots"></i>
            챗봇 상담 시작
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
